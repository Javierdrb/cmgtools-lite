import os
import numpy as np



year = "all"

header = "# {}: {}={} \n".format("vim", "syntax", "sh")
secondline = "# *; LegendCutoff=1e-5 \n"
#plot = '3lep_m3l: mass_3_cheap(LepGood1_pt,LepGood1_eta,LepGood2_pt,LepGood2_eta,LepGood2_phi-LepGood1_phi,LepGood3_pt,LepGood3_eta,LepGood3_phi-LepGood1_phi): 40,0,400; XTitle="M_{3l} (GeV)", MoreY=2.0 \n'
plot_rebined = '3lep_m3l_rebin4: mass_3_cheap(LepGood1_pt,LepGood1_eta,LepGood2_pt,LepGood2_eta,LepGood2_phi-LepGood1_phi,LepGood3_pt,LepGood3_eta,LepGood3_phi-LepGood1_phi): {bining}; XTitle="{title} (GeV)", MoreY=2.0 \n'


channels = []
for njets in [2, 3]:
		for btags in [1, 2]:
			for charge in ["neg", "pos"]:
				channels.append("{}j{}b_{}".format(njets, btags, charge))
channels.append("gt3j1b_pos")
channels.append("gt3j1b_neg")
channels.append("gt3j2b_pos")
channels.append("gt3j2b_neg")


# IMPORTANT!!!!!!
# The correct rebining for ttW is 2016!!! For rebining with other years we would need to:
# 	Create the correspondant plot with a nbins > nbins_desired
#	Rebing with that plot
# 	Run this script
#	Produce plots
#
#	So far we've only done this for 2016, so the rest of the dict's entries are incorrect!!!! 



					# THIS BININGS WERE MADE IN JAN/FEB WITH DATADRIVEN STIMATION

#binings = {"2018" : {'gt3j2b_neg': [0.0, 123.59798997221947, 182.89579453300652, 268.51840578336464, 400.0], 
#		      '3j1b_pos': [0.0, 122.77893972431902, 170.59553360785503, 243.0773826563116, 400.0], 
#		      '2j1b_neg': [0.0, 115.20391528911884, 163.50685889715092, 233.5032564169395, 400.0], 
#		      '2j2b_neg': [0.0, 116.12958415945286, 168.0050980416213, 259.95570571361293, 400.0], 
#		      '3j2b_neg': [0.0, 129.4056768128189, 183.92871785707803, 258.50037025334257, 400.0], 
# 		      '2j1b_pos': [0.0, 115.3243401441726, 157.96934548343037, 224.76647015821993, 400.0], 
#                      '3j2b_pos': [0.0, 129.9138479160506, 189.65244093146933, 266.9238836675627, 400.0], 
#		      '2j2b_pos': [0.0, 122.5032020263458, 190.59385757214082, 252.54422017130855, 400.0], 
#                      'gt3j2b_pos': [0.0, 125.40349376382024, 184.1723975508979, 267.2619567091381, 400.0], 
#                      '3j1b_neg': [0.0, 116.83422093993752, 165.57692681892632, 243.00680935785036, 400.0], 
#                      'gt3j1b_neg': [0.0, 124.47860382097383, 181.86063631764856, 272.20973275839424, 400.0], 
#		      'gt3j1b_pos': [0.0, 119.9619389000917, 176.50790760240818, 265.6478458548198, 400.0]}, 
#	     "2017": {'gt3j2b_neg': [0.0, 113.45544925680608, 176.85659669666543, 248.98333179840446, 400.0],	 
#	       	     '3j1b_pos': [0.0, 99.38061842335816, 154.45160072241632, 216.88446648992857, 400.0],
#               	     '2j1b_neg': [0.0, 107.79179462866591, 158.921075622707, 214.1766909739993, 400.0], 
#               	     '2j2b_neg': [0.0, 122.9634287796631, 191.77107624783193, 302.20949943687384, 400.0], 
# 	       	     '3j2b_neg': [0.0, 109.06736241519667, 168.87466942484255, 239.98909307797567, 400.0],
#               	     '2j1b_pos': [0.0, 107.47594313481852, 155.77453723283665, 221.45778802861759, 400.0], 
#	       	     '3j2b_pos': [0.0, 114.78979677944594, 172.3987185928998, 237.27698312001735, 400.0], 
#               	     '2j2b_pos': [0.0, 96.46514344971574, 170.50958661372601, 221.53289960014382, 400.0], 
# 	       	     'gt3j2b_pos': [0.0, 119.27801999948998, 178.69086376254853, 272.11494345046253, 400.0], 
#	       	     '3j1b_neg': [0.0, 118.44217545320708, 155.2453153316665, 236.9020475282387, 400.0], 
#	       	     'gt3j1b_neg': [0.0, 114.01559979238098, 170.05605300921061, 241.11805131329544, 400.0], 
#	       	     'gt3j1b_pos': [0.0, 127.6874939297328, 178.56919948405726, 263.0524752708587, 400.0]},
#	     "2016" : {'gt3j2b_neg': [0.0, 117.00242597198674, 174.05802435334675, 262.5174606122724, 400.0], 
#		       '3j1b_pos': [0.0, 111.89489223306988, 165.4010900927045, 229.35005238148662, 400.0], 
#		       '2j1b_neg': [0.0, 112.55394782022184, 151.42579187003082, 204.53738428709522, 400.0], 
#		       '2j2b_neg': [0.0, 142.45338149094755, 220.0762048743312, 302.09644948292913, 400.0], 
#		       '3j2b_neg': [0.0, 114.99982583255347, 161.72165963111894, 255.860492918665, 400.0], 
#		       '2j1b_pos': [0.0, 110.4781648369484, 155.94208887711144, 229.30575400784534, 400.0], 
#		       '3j2b_pos': [0.0, 120.73187375242092, 165.71628256038227, 223.05847189725006, 400.0], 
#	               '2j2b_pos': [0.0, 131.59700741944573, 164.8756515762206, 257.84450897407805, 400.0], 
#		       'gt3j2b_pos': [0.0, 119.04935007671595, 172.2768376980128, 243.0648133392594, 400.0], 
#		       '3j1b_neg': [0.0, 111.63057503163434, 149.97924614065317, 214.49169274887205, 400.0], 
#		       'gt3j1b_neg': [0.0, 125.50743609826334, 190.3777120289411, 282.88152893806483, 400.0], 
#		       'gt3j1b_pos': [0.0, 129.92454887327958, 187.07400522253215, 263.0348613634466, 400.0]},
#	     "all" : {'gt3j2b_neg': [0.0, 121.70680369163259, 180.8623689503234, 260.8364540062573, 400.0],
#                       '3j1b_pos': [0.0, 114.76411186452805, 163.96192693957005, 233.86819373027035, 400.0],
#                       '2j1b_neg': [0.0, 112.58121723930597, 159.7652098043936, 224.22668910707375, 400.0],
#                       '2j2b_neg': [0.0, 123.32556799539086, 176.3039544948293, 253.08298805615172, 400.0],
#                       '3j2b_neg': [0.0, 120.06360863322371, 176.12584661257458, 252.29193693145947, 400.0],
#                       '2j1b_pos': [0.0, 112.18314567772688, 157.87413652972302, 226.54929537159802, 400.0],
#                       '3j2b_pos': [0.0, 124.74761462022067, 183.31914841258708, 262.61134797509135, 400.0],
#                       '2j2b_pos': [0.0, 116.64088082618136, 180.58460555877994, 245.3003175231704, 400.0],
#                       'gt3j2b_pos': [0.0, 123.19602223187047, 181.48687495344504, 267.2784083430646, 400.0],
#                       '3j1b_neg': [0.0, 116.39828335425047, 160.91803945608126, 236.13064448589094, 400.0],
#                       'gt3j1b_neg': [0.0, 118.9870517956929, 177.09424326323844, 261.20033163617074, 400.0],
#                       'gt3j1b_pos': [0.0, 125.0029555060229, 183.1916643912864, 259.92425934649845, 400.0]
#			}
#		}

			# THIS BINING WAS MADE IN MARCH 2021 -- LATEST VERSION
#binings = {"all" : {'gt3j2b_neg': [0.0, 116.03432303378179, 175.56185471127299, 260.8356456870091, 400.0],
#          	    '3j1b_pos': [0.0, 114.06645197207538, 166.38337095965758, 237.96850262874517, 400.0],
#          	    '2j1b_neg': [0.0, 103.90165431637568, 145.82505596932182, 213.0857193461154, 400.0],
#          	    '2j2b_neg': [0.0, 121.43406327261727, 173.10237132711543, 255.50637404854558, 400.0],
#          	    '3j2b_neg': [0.0, 120.82317185817638, 183.7079972389815, 261.89607946685123, 400.0],
#          	    '2j1b_pos': [0.0, 106.2781688507018, 148.54960466212705, 214.6474260311017, 400.0], 
#          	    '3j2b_pos': [0.0, 116.84822173627049, 174.25685612830526, 246.66639338107467, 400.0],
#          	    '2j2b_pos': [0.0, 113.09791145793362, 164.3135002667811, 241.12479611401946, 400.0],
#          	    'gt3j2b_pos': [0.0, 119.98748602319276, 177.5327915449384, 253.78928413391765, 400.0],
#          	    '3j1b_neg': [0.0, 112.62257150419242, 160.5222066312638, 233.0193403158247, 400.0],
#          	    'gt3j1b_neg': [0.0, 115.80455369595603, 172.2839908760578, 252.8620012534436, 400.0],
#          	    'gt3j1b_pos': [0.0, 122.2012934115956, 180.22589832793605, 256.618548236995, 400.0]}
#		
#}



			# THIS BINING WAS MADE IN APRIL 2021 -- LATEST VERSION

#binings = { "all" :{'gt3j2b_neg': [0.0, 116.34064794002515, 176.3998498050934, 261.9277450540061, 400.0],
#                    '3j1b_pos': [0.0, 114.711131535693, 168.10609014713228, 240.09698042620778, 400.0],
#                    '2j1b_neg': [0.0, 104.40225104115075, 146.3740275231709, 214.38282783621275, 400.0],
#                    '2j2b_neg': [0.0, 123.93528784607936, 177.71542018139934, 261.34251336893254, 400.0],
#                    '3j2b_neg': [0.0, 119.85546006964611, 184.00078346620185, 262.88710763566877, 400.0],
#                    '2j1b_pos': [0.0, 106.96726684514574, 150.3541478749579, 217.586514790006, 400.0],
#                    '3j2b_pos': [0.0, 117.43035837982565, 174.72993191845063, 245.7917503349408, 400.0],
#                    '2j2b_pos': [0.0, 113.48531953142702, 162.28922908679178, 240.53089935964587, 400.0],
#                    'gt3j2b_pos': [0.0, 119.4905620003257, 177.0550572192971, 252.66864597802237, 400.0],
#                    '3j1b_neg': [0.0, 112.7908448403467, 158.99071913418047, 231.67819897770943, 400.0],
#                    'gt3j1b_neg': [0.0, 114.81198762049463, 172.6254200783287, 255.87213352693408, 400.0],
#                    'gt3j1b_pos': [0.0, 122.81711608068959, 180.55239473539288, 258.873335384784, 400.0]}}

#binings = {"all" : {'gt3j2b_neg': [0.0, 116.53890098602749, 176.9136609679784, 263.04274028183863, 400.0],
#                    '3j1b_pos': [0.0, 115.02957118579673, 167.0710965478581, 239.12887885833595, 400.0],
#                    '2j1b_neg': [0.0, 105.04079995159016, 147.59784925500068, 216.22233102080372, 400.0], 
#                    '2j2b_neg': [0.0, 124.78392900266509, 178.34554639318188, 263.9150134566613, 400.0], 
#                    '3j2b_neg': [0.0, 122.21434822599144, 185.7709345007803, 263.74844675857935, 400.0],
#                    '2j1b_pos': [0.0, 107.47421463663021, 150.48011529810233, 218.3953599200505, 400.0], 
#                    '3j2b_pos': [0.0, 118.47692087936073, 175.51965950773413, 246.66830348146962, 400.0],
#                    '2j2b_pos': [0.0, 113.65447979026759, 166.5721092524327, 244.90803955421018, 400.0],
#                    'gt3j2b_pos': [0.0, 120.34810633053814, 178.03046864225206, 255.00305919492888, 400.0],
#                    '3j1b_neg': [0.0, 112.71775607855469, 159.07398803014027, 232.6440868016628, 400.0],
#                    'gt3j1b_neg': [0.0, 116.12855349817455, 173.52617927461569, 255.8239635536808, 400.0],
#                    'gt3j1b_pos': [0.0, 122.80553114885225, 180.71149901791287, 259.7403008866209, 400.0]}}
#


# From 10 may
#binings = {"all" : {'gt3j2b_neg': [0.0, 116.42353451433229, 176.57305764271126, 262.5842893688223, 400.0],
#                     '3j1b_pos': [0.0, 115.05428285753993, 167.0630541625726, 239.23408384840127, 400.0],
#		     '2j1b_neg': [0.0, 104.71757781904353, 147.18166484580334, 215.89554444745724, 400.0],
#                     '2j2b_neg': [0.0, 123.32369350922865, 176.4106804054444, 260.2640839889815, 400.0],
#                     '3j2b_neg': [0.0, 121.5230120189196, 185.07911764729835, 263.56005417896984, 400.0],
#		     '2j1b_pos': [0.0, 106.90062358207422, 149.83798354988969, 218.50912351440155, 400.0],
#		     '3j2b_pos': [0.0, 117.73139910332944, 174.94828342003913, 246.62413824065484, 400.0],
#		     '2j2b_pos': [0.0, 113.02844637153937, 165.6203318068171, 243.14495263096563, 400.0],
#  		     'gt3j2b_pos': [0.0, 120.23612440693807, 178.1269659028971, 254.4246375634192, 400.0],
#  		     '3j1b_neg': [0.0, 112.34903451038338, 160.2144934492533, 234.1617308300226, 400.0],
# 		     'gt3j1b_neg': [0.0, 115.98114202023226, 172.6312305197804, 253.80925220492455, 400.0],
# 		     'gt3j1b_pos': [0.0, 122.50275380621021, 180.45147209135914, 259.0653319248771, 400.0]} } 

# From 14 July
binings = {"all" : {'gt3j2b_neg': [0.0, 116.87904699690597, 176.9744445678413, 263.1564711045274, 400.0], 
	  	     '3j1b_pos': [0.0, 114.41901760571838, 167.01160526170392, 238.3644737598468, 400.0], 
		     '2j1b_neg': [0.0, 104.04501239963622, 145.92357261173623, 213.11089064762743, 400.0], 
		     '2j2b_neg': [0.0, 122.27468898454849, 174.08453786011336, 256.68040237263375, 400.0], 
		     '3j2b_neg': [0.0, 121.66742805658379, 184.59440374671547, 262.5334359807973, 400.0], 
		     '2j1b_pos': [0.0, 106.61475918456767, 148.90002223766606, 214.94615299472412, 400.0],
		     '3j2b_pos': [0.0, 117.86392817723875, 175.0280421810029, 246.9031888282239, 400.0],
		     '2j2b_pos': [0.0, 113.79555554218635, 165.47193545439086, 242.75509740753085, 400.0], 
		     'gt3j2b_pos': [0.0, 121.08847327321104, 179.06265910671766, 256.82387764863853, 400.0],
		     '3j1b_neg': [0.0, 113.01559787252796, 161.28994169111058, 233.51066271686423, 400.0], 
		     'gt3j1b_neg': [0.0, 116.56814680619217, 173.57752753857946, 254.75168185678595, 400.0],
		     'gt3j1b_pos': [0.0, 122.5891692843204, 180.52139370950675, 257.39690883443814, 400.0]} }
#for ch in channels: 
#	print("{},{}, {}, {}".format(ch, binings["2016"][ch][1]/binings["2017"][ch][1],binings["2016"][ch][2]/binings["2017"][ch][2],binings["2016"][ch][3]/binings["2017"][ch][3]))


for ch in channels:
	f = open("2lss_3l_plots_{ch}.txt".format(ch = ch), "w")
	f.write(header)
	f.write(secondline)
	f.write(plot_rebined.format(bining = binings[year][ch], title = "m_{3l}"))
	f.close()
	
